{"version":3,"file":"vidstack-Dj0oEz46-C1LoZBeY.js","sources":["../node_modules/@vidstack/react/prod/chunks/vidstack-Dj0oEz46.js"],"sourcesContent":["\"use client\"\n\nimport { peek, listenEvent, effect, DOMEvent, isString, camelToKebabCase, isUndefined, isFunction } from './vidstack-CNjv_Zem.js';\nimport { QualitySymbol, RAFLoop, TextTrack, TextTrackSymbol, ListSymbol, IS_CHROME, coerceToError, loadScript, VideoProvider, isHLSSupported, preconnect } from './vidstack-WyKbSRm0.js';\nimport 'react';\nimport '@floating-ui/dom';\n\nconst toDOMEventType = (type) => camelToKebabCase(type);\nclass HLSController {\n  #video;\n  #ctx;\n  #instance = null;\n  #stopLiveSync = null;\n  config = {};\n  #callbacks = /* @__PURE__ */ new Set();\n  get instance() {\n    return this.#instance;\n  }\n  constructor(video, ctx) {\n    this.#video = video;\n    this.#ctx = ctx;\n  }\n  setup(ctor) {\n    const { streamType } = this.#ctx.$state;\n    const isLive = peek(streamType).includes(\"live\"), isLiveLowLatency = peek(streamType).includes(\"ll-\");\n    this.#instance = new ctor({\n      lowLatencyMode: isLiveLowLatency,\n      backBufferLength: isLiveLowLatency ? 4 : isLive ? 8 : void 0,\n      renderTextTracksNatively: false,\n      ...this.config\n    });\n    const dispatcher = this.#dispatchHLSEvent.bind(this);\n    for (const event of Object.values(ctor.Events)) this.#instance.on(event, dispatcher);\n    this.#instance.on(ctor.Events.ERROR, this.#onError.bind(this));\n    for (const callback of this.#callbacks) callback(this.#instance);\n    this.#ctx.player.dispatch(\"hls-instance\", {\n      detail: this.#instance\n    });\n    this.#instance.attachMedia(this.#video);\n    this.#instance.on(ctor.Events.AUDIO_TRACK_SWITCHED, this.#onAudioSwitch.bind(this));\n    this.#instance.on(ctor.Events.LEVEL_SWITCHED, this.#onLevelSwitched.bind(this));\n    this.#instance.on(ctor.Events.LEVEL_LOADED, this.#onLevelLoaded.bind(this));\n    this.#instance.on(ctor.Events.LEVEL_UPDATED, this.#onLevelUpdated.bind(this));\n    this.#instance.on(ctor.Events.NON_NATIVE_TEXT_TRACKS_FOUND, this.#onTracksFound.bind(this));\n    this.#instance.on(ctor.Events.CUES_PARSED, this.#onCuesParsed.bind(this));\n    this.#ctx.qualities[QualitySymbol.enableAuto] = this.#enableAutoQuality.bind(this);\n    listenEvent(this.#ctx.qualities, \"change\", this.#onUserQualityChange.bind(this));\n    listenEvent(this.#ctx.audioTracks, \"change\", this.#onUserAudioChange.bind(this));\n    this.#stopLiveSync = effect(this.#liveSync.bind(this));\n  }\n  #createDOMEvent(type, data) {\n    return new DOMEvent(toDOMEventType(type), { detail: data });\n  }\n  #liveSync() {\n    if (!this.#ctx.$state.live()) return;\n    const raf = new RAFLoop(this.#liveSyncPosition.bind(this));\n    raf.start();\n    return raf.stop.bind(raf);\n  }\n  #liveSyncPosition() {\n    this.#ctx.$state.liveSyncPosition.set(this.#instance?.liveSyncPosition ?? Infinity);\n  }\n  #dispatchHLSEvent(type, data) {\n    this.#ctx.player?.dispatch(this.#createDOMEvent(type, data));\n  }\n  #onTracksFound(eventType, data) {\n    const event = this.#createDOMEvent(eventType, data);\n    let currentTrack = -1;\n    for (let i = 0; i < data.tracks.length; i++) {\n      const nonNativeTrack = data.tracks[i], init = nonNativeTrack.subtitleTrack ?? nonNativeTrack.closedCaptions, track = new TextTrack({\n        id: `hls-${nonNativeTrack.kind}-${i}`,\n        src: init?.url,\n        label: nonNativeTrack.label,\n        language: init?.lang,\n        kind: nonNativeTrack.kind,\n        default: nonNativeTrack.default\n      });\n      track[TextTrackSymbol.readyState] = 2;\n      track[TextTrackSymbol.onModeChange] = () => {\n        if (track.mode === \"showing\") {\n          this.#instance.subtitleTrack = i;\n          currentTrack = i;\n        } else if (currentTrack === i) {\n          this.#instance.subtitleTrack = -1;\n          currentTrack = -1;\n        }\n      };\n      this.#ctx.textTracks.add(track, event);\n    }\n  }\n  #onCuesParsed(eventType, data) {\n    const index = this.#instance?.subtitleTrack, track = this.#ctx.textTracks.getById(`hls-${data.type}-${index}`);\n    if (!track) return;\n    const event = this.#createDOMEvent(eventType, data);\n    for (const cue of data.cues) {\n      cue.positionAlign = \"auto\";\n      track.addCue(cue, event);\n    }\n  }\n  #onAudioSwitch(eventType, data) {\n    const track = this.#ctx.audioTracks[data.id];\n    if (track) {\n      const trigger = this.#createDOMEvent(eventType, data);\n      this.#ctx.audioTracks[ListSymbol.select](track, true, trigger);\n    }\n  }\n  #onLevelSwitched(eventType, data) {\n    const quality = this.#ctx.qualities[data.level];\n    if (quality) {\n      const trigger = this.#createDOMEvent(eventType, data);\n      this.#ctx.qualities[ListSymbol.select](quality, true, trigger);\n    }\n  }\n  #onLevelUpdated(eventType, data) {\n    if (data.details.totalduration > 0) {\n      this.#ctx.$state.inferredLiveDVRWindow.set(data.details.totalduration);\n    }\n  }\n  #onLevelLoaded(eventType, data) {\n    if (this.#ctx.$state.canPlay()) return;\n    const { type, live, totalduration: duration, targetduration } = data.details, trigger = this.#createDOMEvent(eventType, data);\n    this.#ctx.notify(\n      \"stream-type-change\",\n      live ? type === \"EVENT\" && Number.isFinite(duration) && targetduration >= 10 ? \"live:dvr\" : \"live\" : \"on-demand\",\n      trigger\n    );\n    this.#ctx.notify(\"duration-change\", duration, trigger);\n    const media = this.#instance.media;\n    if (this.#instance.currentLevel === -1) {\n      this.#ctx.qualities[QualitySymbol.setAuto](true, trigger);\n    }\n    for (const remoteTrack of this.#instance.audioTracks) {\n      const localTrack = {\n        id: remoteTrack.id.toString(),\n        label: remoteTrack.name,\n        language: remoteTrack.lang || \"\",\n        kind: \"main\"\n      };\n      this.#ctx.audioTracks[ListSymbol.add](localTrack, trigger);\n    }\n    for (const level of this.#instance.levels) {\n      const videoQuality = {\n        id: level.id?.toString() ?? level.height + \"p\",\n        width: level.width,\n        height: level.height,\n        codec: level.codecSet,\n        bitrate: level.bitrate\n      };\n      this.#ctx.qualities[ListSymbol.add](videoQuality, trigger);\n    }\n    media.dispatchEvent(new DOMEvent(\"canplay\", { trigger }));\n  }\n  #onError(eventType, data) {\n    if (data.fatal) {\n      switch (data.type) {\n        case \"mediaError\":\n          this.#instance?.recoverMediaError();\n          break;\n        default:\n          this.#onFatalError(data.error);\n          break;\n      }\n    }\n  }\n  #onFatalError(error) {\n    this.#ctx.notify(\"error\", {\n      message: error.message,\n      code: 1,\n      error\n    });\n  }\n  #enableAutoQuality() {\n    if (this.#instance) this.#instance.currentLevel = -1;\n  }\n  #onUserQualityChange() {\n    const { qualities } = this.#ctx;\n    if (!this.#instance || qualities.auto) return;\n    this.#instance[qualities.switch + \"Level\"] = qualities.selectedIndex;\n    if (IS_CHROME) {\n      this.#video.currentTime = this.#video.currentTime;\n    }\n  }\n  #onUserAudioChange() {\n    const { audioTracks } = this.#ctx;\n    if (this.#instance && this.#instance.audioTrack !== audioTracks.selectedIndex) {\n      this.#instance.audioTrack = audioTracks.selectedIndex;\n    }\n  }\n  onInstance(callback) {\n    this.#callbacks.add(callback);\n    return () => this.#callbacks.delete(callback);\n  }\n  loadSource(src) {\n    if (!isString(src.src)) return;\n    this.#instance?.loadSource(src.src);\n  }\n  destroy() {\n    this.#instance?.destroy();\n    this.#instance = null;\n    this.#stopLiveSync?.();\n    this.#stopLiveSync = null;\n  }\n}\n\nclass HLSLibLoader {\n  #lib;\n  #ctx;\n  #callback;\n  constructor(lib, ctx, callback) {\n    this.#lib = lib;\n    this.#ctx = ctx;\n    this.#callback = callback;\n    this.#startLoading();\n  }\n  async #startLoading() {\n    const callbacks = {\n      onLoadStart: this.#onLoadStart.bind(this),\n      onLoaded: this.#onLoaded.bind(this),\n      onLoadError: this.#onLoadError.bind(this)\n    };\n    let ctor = await loadHLSScript(this.#lib, callbacks);\n    if (isUndefined(ctor) && !isString(this.#lib)) ctor = await importHLS(this.#lib, callbacks);\n    if (!ctor) return null;\n    if (!ctor.isSupported()) {\n      const message = \"[vidstack] `hls.js` is not supported in this environment\";\n      this.#ctx.player.dispatch(new DOMEvent(\"hls-unsupported\"));\n      this.#ctx.notify(\"error\", { message, code: 4 });\n      return null;\n    }\n    return ctor;\n  }\n  #onLoadStart() {\n    this.#ctx.player.dispatch(new DOMEvent(\"hls-lib-load-start\"));\n  }\n  #onLoaded(ctor) {\n    this.#ctx.player.dispatch(\n      new DOMEvent(\"hls-lib-loaded\", {\n        detail: ctor\n      })\n    );\n    this.#callback(ctor);\n  }\n  #onLoadError(e) {\n    const error = coerceToError(e);\n    this.#ctx.player.dispatch(\n      new DOMEvent(\"hls-lib-load-error\", {\n        detail: error\n      })\n    );\n    this.#ctx.notify(\"error\", {\n      message: error.message,\n      code: 4,\n      error\n    });\n  }\n}\nasync function importHLS(loader, callbacks = {}) {\n  if (isUndefined(loader)) return void 0;\n  callbacks.onLoadStart?.();\n  if (loader.prototype && loader.prototype !== Function) {\n    callbacks.onLoaded?.(loader);\n    return loader;\n  }\n  try {\n    const ctor = (await loader())?.default;\n    if (ctor && !!ctor.isSupported) {\n      callbacks.onLoaded?.(ctor);\n    } else {\n      throw Error(\n        false ? \"[vidstack] failed importing `hls.js`. Dynamic import returned invalid constructor.\" : \"\"\n      );\n    }\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\nasync function loadHLSScript(src, callbacks = {}) {\n  if (!isString(src)) return void 0;\n  callbacks.onLoadStart?.();\n  try {\n    await loadScript(src);\n    if (!isFunction(window.Hls)) {\n      throw Error(\n        false ? \"[vidstack] failed loading `hls.js`. Could not find a valid `Hls` constructor on window\" : \"\"\n      );\n    }\n    const ctor = window.Hls;\n    callbacks.onLoaded?.(ctor);\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\n\nconst JS_DELIVR_CDN = \"https://cdn.jsdelivr.net\";\nclass HLSProvider extends VideoProvider {\n  $$PROVIDER_TYPE = \"HLS\";\n  #ctor = null;\n  #controller = new HLSController(this.video, this.ctx);\n  /**\n   * The `hls.js` constructor.\n   */\n  get ctor() {\n    return this.#ctor;\n  }\n  /**\n   * The current `hls.js` instance.\n   */\n  get instance() {\n    return this.#controller.instance;\n  }\n  /**\n   * Whether `hls.js` is supported in this environment.\n   */\n  static supported = isHLSSupported();\n  get type() {\n    return \"hls\";\n  }\n  get canLiveSync() {\n    return true;\n  }\n  #library = `${JS_DELIVR_CDN}/npm/hls.js@^1.5.0/dist/hls${\".min.js\"}`;\n  /**\n   * The `hls.js` configuration object.\n   *\n   * @see {@link https://github.com/video-dev/hls.js/blob/master/docs/API.md#fine-tuning}\n   */\n  get config() {\n    return this.#controller.config;\n  }\n  set config(config) {\n    this.#controller.config = config;\n  }\n  /**\n   * The `hls.js` constructor (supports dynamic imports) or a URL of where it can be found.\n   *\n   * @defaultValue `https://cdn.jsdelivr.net/npm/hls.js@^1.0.0/dist/hls.min.js`\n   */\n  get library() {\n    return this.#library;\n  }\n  set library(library) {\n    this.#library = library;\n  }\n  preconnect() {\n    if (!isString(this.#library)) return;\n    preconnect(this.#library);\n  }\n  setup() {\n    super.setup();\n    new HLSLibLoader(this.#library, this.ctx, (ctor) => {\n      this.#ctor = ctor;\n      this.#controller.setup(ctor);\n      this.ctx.notify(\"provider-setup\", this);\n      const src = peek(this.ctx.$state.source);\n      if (src) this.loadSource(src);\n    });\n  }\n  async loadSource(src, preload) {\n    if (!isString(src.src)) {\n      this.removeSource();\n      return;\n    }\n    this.media.preload = preload || \"\";\n    this.appendSource(src, \"application/x-mpegurl\");\n    this.#controller.loadSource(src);\n    this.currentSrc = src;\n  }\n  /**\n   * The given callback is invoked when a new `hls.js` instance is created and right before it's\n   * attached to media.\n   */\n  onInstance(callback) {\n    const instance = this.#controller.instance;\n    if (instance) callback(instance);\n    return this.#controller.onInstance(callback);\n  }\n  destroy() {\n    this.#controller.destroy();\n  }\n}\n\nexport { HLSProvider };\n"],"names":["toDOMEventType","type","camelToKebabCase","HLSController","video","ctx","__privateAdd","_HLSController_instances","_video","_ctx","_instance","_stopLiveSync","__publicField","_callbacks","__privateSet","__privateGet","ctor","streamType","isLive","peek","isLiveLowLatency","dispatcher","__privateMethod","dispatchHLSEvent_fn","event","onError_fn","callback","onAudioSwitch_fn","onLevelSwitched_fn","onLevelLoaded_fn","onLevelUpdated_fn","onTracksFound_fn","onCuesParsed_fn","QualitySymbol","enableAutoQuality_fn","listenEvent","onUserQualityChange_fn","onUserAudioChange_fn","effect","liveSync_fn","src","isString","_a","_b","createDOMEvent_fn","data","DOMEvent","raf","RAFLoop","liveSyncPosition_fn","eventType","currentTrack","i","nonNativeTrack","init","track","TextTrack","TextTrackSymbol","index","cue","trigger","ListSymbol","quality","live","duration","targetduration","media","remoteTrack","localTrack","level","videoQuality","onFatalError_fn","error","qualities","IS_CHROME","audioTracks","HLSLibLoader","lib","_HLSLibLoader_instances","_lib","_callback","startLoading_fn","callbacks","onLoadStart_fn","onLoaded_fn","onLoadError_fn","loadHLSScript","isUndefined","importHLS","message","e","coerceToError","loader","_c","_d","err","_e","loadScript","isFunction","JS_DELIVR_CDN","HLSProvider","VideoProvider","_ctor","_controller","_library","config","library","preconnect","preload","instance","isHLSSupported"],"mappings":"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","x_google_ignoreList":[0]}