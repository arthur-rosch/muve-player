{"version":3,"file":"vidstack-CcKOND9e-BXJPHZEc.js","sources":["../node_modules/@vidstack/react/prod/chunks/vidstack-CcKOND9e.js"],"sourcesContent":["\"use client\"\n\nimport { appendParamsToURL, IS_SERVER } from './vidstack-WyKbSRm0.js';\nimport { signal, listenEvent, effect, peek, isString } from './vidstack-CNjv_Zem.js';\n\nclass EmbedProvider {\n  #iframe;\n  src = signal(\"\");\n  /**\n   * Defines which referrer is sent when fetching the resource.\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/referrerPolicy}\n   */\n  referrerPolicy = null;\n  get iframe() {\n    return this.#iframe;\n  }\n  constructor(iframe) {\n    this.#iframe = iframe;\n    iframe.setAttribute(\"frameBorder\", \"0\");\n    iframe.setAttribute(\"aria-hidden\", \"true\");\n    iframe.setAttribute(\n      \"allow\",\n      \"autoplay; fullscreen; encrypted-media; picture-in-picture; accelerometer; gyroscope\"\n    );\n    if (this.referrerPolicy !== null) {\n      iframe.setAttribute(\"referrerpolicy\", this.referrerPolicy);\n    }\n  }\n  setup() {\n    listenEvent(window, \"message\", this.#onWindowMessage.bind(this));\n    listenEvent(this.#iframe, \"load\", this.onLoad.bind(this));\n    effect(this.#watchSrc.bind(this));\n  }\n  #watchSrc() {\n    const src = this.src();\n    if (!src.length) {\n      this.#iframe.setAttribute(\"src\", \"\");\n      return;\n    }\n    const params = peek(() => this.buildParams());\n    this.#iframe.setAttribute(\"src\", appendParamsToURL(src, params));\n  }\n  postMessage(message, target) {\n    if (IS_SERVER) return;\n    this.#iframe.contentWindow?.postMessage(JSON.stringify(message), target ?? \"*\");\n  }\n  #onWindowMessage(event) {\n    const origin = this.getOrigin(), isOriginMatch = (event.source === null || event.source === this.#iframe?.contentWindow) && (!isString(origin) || origin === event.origin);\n    if (!isOriginMatch) return;\n    try {\n      const message = JSON.parse(event.data);\n      if (message) this.onMessage(message, event);\n      return;\n    } catch (e) {\n    }\n    if (event.data) this.onMessage(event.data, event);\n  }\n}\n\nexport { EmbedProvider };\n"],"names":["EmbedProvider","iframe","__privateAdd","_EmbedProvider_instances","_iframe","__publicField","signal","__privateSet","__privateGet","listenEvent","__privateMethod","onWindowMessage_fn","effect","watchSrc_fn","message","target","IS_SERVER","_a","src","params","peek","appendParamsToURL","event","origin","isString"],"mappings":";;;;;;;;;AAKA,MAAMA,EAAc;AAAA,EAYlB,YAAYC,GAAQ;AAZtB,IAAAC,EAAA,MAAAC;AACE,IAAAD,EAAA,MAAAE;AACA,IAAAC,EAAA,aAAMC,EAAO,EAAE;AAMf;AAAA;AAAA;AAAA;AAAA;AAAA,IAAAD,EAAA,wBAAiB;AAKf,IAAAE,EAAA,MAAKH,GAAUH,IACfA,EAAO,aAAa,eAAe,GAAG,GACtCA,EAAO,aAAa,eAAe,MAAM,GACzCA,EAAO;AAAA,MACL;AAAA,MACA;AAAA,IACD,GACG,KAAK,mBAAmB,QAC1BA,EAAO,aAAa,kBAAkB,KAAK,cAAc;AAAA,EAE/D;AAAA,EAdE,IAAI,SAAS;AACX,WAAOO,EAAA,MAAKJ;AAAA,EAChB;AAAA,EAaE,QAAQ;AACN,IAAAK,EAAY,QAAQ,WAAWC,EAAA,MAAKP,GAAAQ,GAAiB,KAAK,IAAI,CAAC,GAC/DF,EAAYD,EAAA,MAAKJ,IAAS,QAAQ,KAAK,OAAO,KAAK,IAAI,CAAC,GACxDQ,EAAOF,EAAA,MAAKP,GAAAU,GAAU,KAAK,IAAI,CAAC;AAAA,EACpC;AAAA,EAUE,YAAYC,GAASC,GAAQ;;AAC3B,IAAIC,MACJC,IAAAT,EAAA,MAAKJ,GAAQ,kBAAb,QAAAa,EAA4B,YAAY,KAAK,UAAUH,CAAO,GAAGC,KAAU;AAAA,EAC/E;AAYA;AApDEX,IAAA,eADFD,IAAA,eA6BEU,IAAS,WAAG;AACV,QAAMK,IAAM,KAAK,IAAK;AACtB,MAAI,CAACA,EAAI,QAAQ;AACf,IAAAV,EAAA,MAAKJ,GAAQ,aAAa,OAAO,EAAE;AACnC;AAAA,EACN;AACI,QAAMe,IAASC,EAAK,MAAM,KAAK,YAAW,CAAE;AAC5C,EAAAZ,EAAA,MAAKJ,GAAQ,aAAa,OAAOiB,EAAkBH,GAAKC,CAAM,CAAC;AACnE,GAKER,IAAgB,SAACW,GAAO;;AACtB,QAAMC,IAAS,KAAK,UAAW;AAC/B,OADkDD,EAAM,WAAW,QAAQA,EAAM,aAAWL,IAAAT,EAAA,MAAKJ,OAAL,gBAAAa,EAAc,oBAAmB,CAACO,EAASD,CAAM,KAAKA,MAAWD,EAAM,SAEnK;AAAA,QAAI;AACF,YAAMR,IAAU,KAAK,MAAMQ,EAAM,IAAI;AACrC,MAAIR,KAAS,KAAK,UAAUA,GAASQ,CAAK;AAC1C;AAAA,IACD,QAAW;AAAA,IAChB;AACI,IAAIA,EAAM,QAAM,KAAK,UAAUA,EAAM,MAAMA,CAAK;AAAA;AACpD;","x_google_ignoreList":[0]}